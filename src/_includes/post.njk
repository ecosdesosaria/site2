---
layout: base.njk
---

<div class="container my-5">

  <div class="uo-section">

    <h1 class="mb-2">{{ title }}</h1>

    <p class="text-muted mb-4">
      {{ page.date | readableDate }}
    </p>

    <div class="post-content">
      {{ content | safe }}
    </div>
    
    <div class="uo-section mt-5">
      <h3>Comentários</h3>
      <small>Para comentar é necessário responder a postagem no <a href="https://bolha.us/@ecosdesosaria" target="_blank">Mastodon</a></small>.
      <br><br>
      <div id="comments">Carregando comentários...</div>
    </div>

    <div class="mt-5">
      <a href="/blog/" class="uo-btn btn-sm">← Voltar ao blog</a>
    </div>

  </div>

</div>


<script>
const url = window.location.href;

fetch(`https://webmention.io/api/mentions.jf2?target=${encodeURIComponent(url)}`)
  .then(r => r.json())
  .then(data => {
    const comments = data.children.filter(m => m["wm-property"] === "in-reply-to");

    const container = document.getElementById("comments");

    if (!comments.length) {
      container.innerHTML = "<p>Nenhum comentário ainda.</p>";
      return;
    }

    container.innerHTML = comments.map(c => `
      <div class="uo-card p-3 mb-3">
        <strong>${c.author?.name || "Anônimo"}</strong><br>
        <small>${new Date(c.published).toLocaleDateString("pt-BR")}</small>
        <p>${c.content?.text || ""}</p>
      </div>
    `).join("");
  });
</script>
